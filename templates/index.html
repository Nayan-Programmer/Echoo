<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ assistant_name }} - AI Assistant</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
    body{margin:0;font-family:'Inter',sans-serif;background:#000;color:#fff;}
    .container{max-width:800px;margin:0 auto;padding:20px;}
    .chat{margin-top:20px;}
    .message{margin-bottom:10px;}
    .user{color:#0ff;}
    .ai{color:#ff0;}
    #messageInput{width:80%;padding:10px;border-radius:5px;border:none;}
    #sendBtn{padding:10px;border:none;border-radius:5px;background:#0ff;color:#000;cursor:pointer;}
</style>
</head>
<body>
<div class="container">
    <h1>Welcome to {{ assistant_name }}</h1>
    {% if user %}
        <p>Hello, {{ user['name'] }}! <a href="{{ url_for('logout') }}">Logout</a></p>
    {% else %}
        <a href="{{ url_for('google.login') }}"><button>Login with Google</button></a>
    {% endif %}

    <div class="chat">
        <div id="chatContainer"></div>
        <input type="text" id="messageInput" placeholder="Type message...">
        <button id="sendBtn">Send</button>
    </div>
</div>

<script>
const chatContainer = document.getElementById('chatContainer');
const input = document.getElementById('messageInput');
const sendBtn = document.getElementById('sendBtn');

sendBtn.onclick = async () => {
    const text = input.value.trim();
    if(!text) return;
    appendMessage('user', text);
    input.value='';

    const res = await fetch('/chat',{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({message:text})
    });
    const data = await res.json();
    appendMessage('ai', data.reply);
};

function appendMessage(type, text){
    const div = document.createElement('div');
    div.className = 'message ' + type;
    div.textContent = (type==='user'?'You: ':'AI: ') + text;
    chatContainer.appendChild(div);
    chatContainer.scrollTop = chatContainer.scrollHeight;
}
</script>
</body>
</html>
